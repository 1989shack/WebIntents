(function(){if(!window.Intent){var a="http://webintents.org/",b=a,c=b+"intents.html",d=b+"picker.html",e,f={},g={},h=function(){};h.prototype.startActivity=function(a,b){var c="intent."+(new Date).valueOf(),f=document.all?window.screenLeft:window.screenX,h=document.all?window.screenTop:window.screenY,j="directories=no,menubar=no,status=0,location=0,fullscreen=yes",k=window.open(d,c,j);k.resizeTo(300,300),k.moveTo(f+40,document.body.offsetHeight+h),a._id=c,g[c]={intent:a},b&&(e.contentWindow.postMessage(i({request:"registerCallback",id:c}),"*"),g[c].callback=b)};var i=function(a){return JSON.stringify(a)},j=function(a){var b=JSON.parse(a.data);if(b.request&&b.request=="ready"){var c=b.id,d=g[c];a.source.postMessage(i({request:"startActivity",intent:d.intent}),"*")}else b.request&&b.request=="intentData"?k(b.intent):b.request&&b.request=="response"&&g[b.intent._id].callback(b.intent)};window.addEventListener("message",j,!1);var k=function(a){var b=new m;b._id=a._id,b.action=a.action,b.type=a.type,b.data=a.data,window.intent=b},l=function(a,b,c,d,f){!!c==!1&&(c=document.location.toString()),c.substring(0,7)!="http://"&&c.substring(0,8)!="https://"&&(c.substring(0,1)=="/"?c=document.location.origin+c:(path=document.location.href,path=path.substring(0,path.lastIndexOf("/")+1),c=path+c)),e.contentWindow.postMessage(i({request:"register",intent:{action:a,type:b,url:c,title:d,icon:f,domain:window.location.host}}),"*")},m=function(a,b,c){var d=this;this.action=a,this.type=b,this.data=c,this.postResult=function(a){var b=new m;b._id=d._id,b.action=d.action,b.data=a,e.contentWindow.postMessage(i({request:"response",intent:b}),"*")}};m.SHARE="http://webintents.org/share",m.SEND="http://webintents.org/send",m.EDIT="http://webintents.org/edit",m.VIEW="http://webintents.org/view",m.PICK="http://webintents.org/pick";var n=function(){var a=document.getElementsByTagName("link"),b;for(var c=0;b=a[c];c++)if((b.rel=="icon"||b.rel=="shortcut")&&!!b.href){var d=b.href;if(d.substring(0,7)=="http://"||d.substring(0,8)=="https://")return d;if(d.substring(0,1)=="/")return document.location.origin+d;path=document.location.href,path=path.substring(0,path.lastIndexOf("/")+1),d=path+d}return window.location.origin+"/favicon.ico"},o=function(){var a=document.getElementsByTagName("meta"),b;for(var c=0;b=a[c];c++){var d=b.getAttribute("name");if(d=="intent"){var e=b.getAttribute("title"),f=b.getAttribute("href"),g=b.getAttribute("content"),h=b.getAttribute("type"),i=b.getAttribute("icon")||n();l(g,h,f,e,i)}}},p=function(a){var b=a.getAttribute("title"),c=a.getAttribute("href"),d=a.getAttribute("action"),e=a.getAttribute("type"),f=a.getAttribute("icon")||n();!!d!=!1&&l(d,e,c,b,f)},q=function(){var a=document.getElementsByTagName("intent"),b;for(var c=0;b=a[c];c++)p(b)},r=function(a){var b=a.target;if(b.method.toLowerCase()=="intent"){a.preventDefault();var c=b.action,d=b.getAttribute("enctype"),e={},f;for(var g=0;f=b.elements[g];g++)if(!!f.name){var h=f.name;if(!e[h])e[h]=f.value;else if(e[h]instanceof Array)e[h].push(f.value);else{var i=[e[h]];i.push(f.value),e[h]=i}}var j=new m(c,d,e);window.navigator.startActivity(j);return!1}},s=function(a){a.target.tagName=="INTENT"&&p(a.target)},t=function(){window.opener&&window.opener.closed==!1&&window.opener.postMessage(i({request:"launched",name:window.name}),"*")},u=function(){var a=new h;window.Intent=m,window.navigator.startActivity=a.startActivity;if(window.name)try{k(JSON.parse(window.name))}catch(d){t()}else t();!window.postMessage||(e=document.createElement("iframe"),e.style.display="none",e.src=c,e.addEventListener("load",function(){q(),o()},!1),document.head.addEventListener("DOMNodeInserted",s,!1),document.head.appendChild(e)),window.opener&&window.opener.postMessage(i({request:"ready"}),b),window.addEventListener("submit",r,!1)};u()}})()