<% content_for(:title) do %>Discovery<% end %>
<% content_for(:js) do %>
  <%= javascript_include_tag :webintents %>
  <intent
    action="http://webintents.org/discover"
    type="application/JSON"
    href="discover.html"
    title="Example.com's APIs"
    />
  <%= javascript_include_tag :events %>
  <script>

    attachEventListener(window, "load", function() {
      var use = document.getElementById("use");
      attachEventListener(use, "click", function() {
        if(!!window.intent) {
          var data = [
            {
              action: "http://example.com/purchase",
              title: "A New type of Purchase intent"
            },
            {
              action: "http://example.com/book",
              title: "A way to book a resource such as a table, or ticket"
            }
          ];
          window.intent.postResult(data);
          setTimeout(function() { window.close();}, 500);
        }

    });
   }, false);

  </script>
<% end %>
<h2>Code</h2>
<button id="use">Use</button>
<pre>
</pre>
