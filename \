var shareElement = document.getElementsByClassName("twitter-anywhere-tweet-box-editor")[0];

var addIntent = function() {
  // Always add the intent in.
  var intentEl = document.createElement("intent");
  intentEl.setAttribute("action", "http://webintents.org/share");
  intentEl.setAttribute("type", "text/uri-list");
  intentEl.setAttribute("href", document.location.href);
  document.head.appendChild(intentEl);
};

var checkIntent = function() {
  setTimeout(function() {
     var script = document.createElement("script");
     document.head.appendChild(script);
     shareElement.value = window.intent.data;
  }, 0);
}

if(document.readyState == "complete") {
  addIntent();
  checkIntent();
}
else {
  window.addEventListener("load", addIntent, false);
  window.addEventListener("load", checkIntent, false);
}
